from openai import OpenAI
client = OpenAI()

def generate_answer(query: str, context: str | None = None) -> str:
    base_prompt = (
        "You are Tripsy, a fun and friendly travel buddy. "
        "Speak casually and naturally, like chatting with a friend. "
        "Keep replies short (2–3 sentences), warm, and practical. "
        "If the user just says 'hi' or similar, greet them casually. "
        "If thanking you, acknowledge and offer help. "
        "When suggesting trips, avoid long lists—give 1–2 ideas only. "
        "Never sound like a tour brochure or AI disclaimer."
    )

    if context:
        base_prompt += f"\nUse this info if relevant:\n{context}"

    resp = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=[
            {"role": "system", "content": base_prompt},
            {"role": "user", "content": query}
        ],
        max_tokens=180,
        temperature=0.8
    )
    return resp.choices[0].message.content.strip()
